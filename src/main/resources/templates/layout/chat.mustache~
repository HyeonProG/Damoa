<!DOCTYPE html>
<html lang="en">
<head>
    <style>
        /* ì „ì²´ í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #F0F0F0; /* ì—°í•œ íšŒìƒ‰ ë°°ê²½ */
            margin: 0;
            padding: 20px;
        }

        /* ë„¤ë¹„ê²Œì´ì…˜ ë°” ìŠ¤íƒ€ì¼ */
        .navbar {
            padding: 10px; /* íŒ¨ë”© ì¶”ê°€ */
            display: flex;
            justify-content: flex-end; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
            position: relative; /* ìì‹ ìš”ì†Œì— ëŒ€í•´ ìƒëŒ€ì  ìœ„ì¹˜ ì§€ì • */
            z-index: 1000; /* ë„¤ë¹„ê²Œì´ì…˜ ë°”ê°€ ìœ„ì— ì˜¤ë„ë¡ ì„¤ì • */
        }

        /* ì±„íŒ… ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
        .chat-icon {
            background-color: #A8E05C; /* ì—°ë‘ìƒ‰ */
            border: none; /* í…Œë‘ë¦¬ ì œê±° */
            border-radius: 50%; /* ì›í˜• */
            padding: 10px; /* ë‚´ë¶€ ì—¬ë°± */
            cursor: pointer; /* í´ë¦­ ê°€ëŠ¥ ì»¤ì„œ */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* ì•½ê°„ì˜ ê·¸ë¦¼ì ì¶”ê°€ */
            transition: background-color 0.3s; /* í˜¸ë²„ íš¨ê³¼ë¥¼ ë¶€ë“œëŸ½ê²Œ */
            font-size: 24px; /* ì•„ì´ì½˜ í¬ê¸° */
            position: fixed; /* ìŠ¤í¬ë¡¤ì— ë”°ë¼ ìœ„ì¹˜ ê³ ì • */
            bottom: 100px; /* í™”ë©´ ì•„ë˜ì—ì„œì˜ ê±°ë¦¬ */
            right: 20px; /* í™”ë©´ ì˜¤ë¥¸ìª½ì—ì„œì˜ ê±°ë¦¬ */
            z-index: 1001; /* ë‹¤ë¥¸ ìš”ì†Œë“¤ë³´ë‹¤ ìœ„ì— í‘œì‹œ */
        }

        /* ì±„íŒ… ì•„ì´ì½˜ í˜¸ë²„ íš¨ê³¼ */
        .chat-icon:hover {
            background-color: rgba(168, 224, 92, 0.8); /* í˜¸ë²„ ì‹œ ì—°ë‘ìƒ‰ */
        }

        /* ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
        .message {
            border-radius: 10px;
            padding: 10px;
            margin: 5px 0;
            max-width: 75%; /* ìµœëŒ€ ë„ˆë¹„ ì„¤ì • */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* ì•½ê°„ì˜ ê·¸ë¦¼ì ì¶”ê°€ */
            font-size: 14px; /* ë©”ì‹œì§€ ê¸€ì”¨ í¬ê¸° */
            background-color: #A8E05C; /* ì—°ë‘ìƒ‰ */
            position: relative; /* ì´ëª¨í‹°ì½˜ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„¤ì • */
        }

        /* ë‚´ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ (ì˜¤ë¥¸ìª½ ì •ë ¬) */
        .message-right {
            align-self: flex-end; /* ì˜¤ë¥¸ìª½ ì •ë ¬ */
        }

        /* ìƒëŒ€ë°© ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ (ì™¼ìª½ ì •ë ¬) */
        .message-left {
            align-self: flex-start; /* ì™¼ìª½ ì •ë ¬ */
        }

        /* ì±„íŒ… ë¡œê·¸ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        #messages {
            background-color: #FFFFFF; /* í°ìƒ‰ */
            height: 400px; /* ì ì ˆí•œ ë†’ì´ ì„¤ì • */
            overflow-y: auto; /* ìŠ¤í¬ë¡¤ë°” ì¶”ê°€ */
            border: 1px solid #A8E05C; /* ì—°ë‘ìƒ‰ í…Œë‘ë¦¬ë¡œ ë³€ê²½ */
            padding: 10px;
            margin-bottom: 10px; /* ì…ë ¥ ê·¸ë£¹ê³¼ì˜ ê°„ê²© ì„¤ì • */
            display: flex;
            flex-direction: column-reverse; /* ë©”ì‹œì§€ë¥¼ ì•„ë˜ì—ì„œ ìœ„ë¡œ ìŒ“ì´ë„ë¡ ì„¤ì • */
            border-radius: 10px; /* ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ */
        }

        /* ì…ë ¥ ê·¸ë£¹ ìŠ¤íƒ€ì¼ */
        .input-group {
            display: flex;
            position: fixed; /* ì…ë ¥ ê·¸ë£¹ì„ ìƒëŒ€ì ìœ¼ë¡œ ì„¤ì • */
            bottom: 70px; /* ì•„ì´ì½˜ ìœ„ìª½ì— í‘œì‹œë˜ë„ë¡ ìœ„ì¹˜ ì¡°ì • */
            right: 20px; /* ì˜¤ë¥¸ìª½ì—ì„œì˜ ê±°ë¦¬ ì„¤ì • */
            z-index: 999; /* ìœ„ìª½ì— í‘œì‹œ */
            width: 300px; /* ì±„íŒ…ë°©ê³¼ ë™ì¼í•œ ë„ˆë¹„ ì„¤ì • */
            display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
        }

        /* ì…ë ¥ë€ ìŠ¤íƒ€ì¼ */
        #message {
            flex: 1; /* ê°€ëŠ¥í•œ ëª¨ë“  ê³µê°„ ì°¨ì§€ */
            border: 1px solid #A8E05C; /* ì—°ë‘ìƒ‰ í…Œë‘ë¦¬ */
            border-radius: 5px; /* ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ */
            padding: 10px; /* ë‚´ë¶€ ì—¬ë°± */
            font-size: 14px; /* ê¸€ì”¨ í¬ê¸° */
            margin: 0; /* ê°„ê²© ì œê±° */
        }

        /* ì±„íŒ…ë°© ê¸°ë³¸ ìˆ¨ê¹€ ì„¤ì • */
        #chat-room {
            display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€ */
            position: fixed; /* ê³ ì •ëœ ìœ„ì¹˜ ì„¤ì • */
            bottom: 70px; /* ì•„ì´ì½˜ ìœ„ìª½ì— í‘œì‹œë˜ë„ë¡ ìœ„ì¹˜ ì¡°ì • */
            right: 20px; /* ì˜¤ë¥¸ìª½ì—ì„œì˜ ê±°ë¦¬ ì„¤ì • */
            width: 300px; /* ì±„íŒ…ë°© ë„ˆë¹„ ì„¤ì • */
            max-height: 500px; /* ìµœëŒ€ ë†’ì´ ì„¤ì • */
            overflow: hidden; /* ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¸°ê¸° */
            z-index: 999; /* ìœ„ìª½ì— í‘œì‹œ */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3); /* ê·¸ë¦¼ì ì¶”ê°€ */
        }

        /* ë’¤ë¡œê°€ê¸° ë°” ìŠ¤íƒ€ì¼ */
        .back-bar {
            background-color: #A8E05C; /* ì—°ë‘ìƒ‰ ë°°ê²½ */
            padding: 10px; /* íŒ¨ë”© ì¶”ê°€ */
            cursor: pointer; /* ì»¤ì„œ ë³€ê²½ */
            color: white; /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
            font-size: 16px; /* í…ìŠ¤íŠ¸ í¬ê¸° */
            display: flex; /* ë°” ì•ˆì˜ ìš”ì†Œë¥¼ ì¢Œìš° ì •ë ¬ */
            justify-content: flex-start; /* ë’¤ë¡œê°€ê¸° ì´ëª¨í‹°ì½˜ì„ ì™¼ìª½ ì •ë ¬ */
            align-items: center; /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
            border-radius: 8px; /* ë°”ì˜ ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* ì•½ê°„ì˜ ê·¸ë¦¼ì */
            transition: background-color 0.3s ease; /* í˜¸ë²„ ì‹œ ë°°ê²½ìƒ‰ ë³€ê²½ ì• ë‹ˆë©”ì´ì…˜ */
        }

        /* ë’¤ë¡œê°€ê¸° ë°” í˜¸ë²„ íš¨ê³¼ */
        .back-bar:hover {
            background-color: rgba(168, 224, 92, 0.9); /* í˜¸ë²„ ì‹œ ë°ê²Œ */
        }

        /* ë’¤ë¡œê°€ê¸° ë²„íŠ¼ í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .back-bar button {
            background: none; /* ë°°ê²½ ì œê±° */
            border: none; /* í…Œë‘ë¦¬ ì œê±° */
            color: white; /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
            font-size: 18px; /* ê¸€ì”¨ í¬ê¸° */
            cursor: pointer; /* í´ë¦­ ê°€ëŠ¥ ì»¤ì„œ */
        }

         /* ë’¤ë¡œê°€ê¸° ë°”ì˜ í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .back-bar p {
            padding: 10px 10px;
            margin: 0; /* ê¸°ë³¸ ì—¬ë°± ì œê±° */
            color: white; /* í°ìƒ‰ í…ìŠ¤íŠ¸ */
            text-align: left; /* ì™¼ìª½ ì •ë ¬ */
            width: 100%; /* ë¶€ëª¨ ìš”ì†Œì— ë§ì¶¤ */
        }
    </style>
</head>
<body>
<div class="navbar">
    <button class="chat-icon" id="chat-icon" onclick="showChatRoom()">ğŸ’¬</button> <!-- ì±„íŒ… ì•„ì´ì½˜ -->
</div>

<div id="chat-room"> <!-- ì±„íŒ…ë°© -->
    <div class="back-bar">
        <button id="back-button">â†</button> <!-- ë’¤ë¡œê°€ê¸° í…ìŠ¤íŠ¸ ë²„íŠ¼ -->
        <p>ê¹€ê¸°ì„ë‹˜ê³¼ì˜ ì±„íŒ…</p>
    </div>
    <div id="messages"></div> <!-- ë©”ì‹œì§€ ë¡œê·¸ -->
</div>

<!-- ë©”ì‹œì§€ ì…ë ¥ ê·¸ë£¹ ê³ ì • ìœ„ì¹˜ -->
<div class="input-group" id="input-group"> <!-- ID ì¶”ê°€ -->
    <input type="text" id="message" class="form-control" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." />
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.0/sockjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<script>
    const companyId = prompt("ë‚´ ì•„ì´ë”” ì…ë ¥:"); // í´ë¼ì´ì–¸íŠ¸ ID ì…ë ¥
    const freelancerId = prompt("ìƒëŒ€ë°© ì•„ì´ë”” ì…ë ¥:"); // í”„ë¦¬ëœì„œ ID ì…ë ¥
    const socket = new SockJS('/ws');
    const stompClient = Stomp.over(socket);

    function connect() {
        stompClient.connect({}, function (frame) {
            console.log('Connected: ' + frame);
            stompClient.subscribe('/topic/messages', function (message) {
                const chatMessage = JSON.parse(message.body);
                // ë©”ì‹œì§€ ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ê²°ì •
                const messageBox = chatMessage.companyId === companyId
                    ? `<div class='message message-right'>${chatMessage.message}</div>` // ìì‹ ì˜ ë©”ì‹œì§€
                    : `<div class='message message-left'><strong>${chatMessage.companyId}:</strong> ${chatMessage.message}</div>`; // ìƒëŒ€ë°©ì˜ ë©”ì‹œì§€

                // ë©”ì‹œì§€ ì¶”ê°€
                const messagesDiv = document.getElementById('messages');
                messagesDiv.insertAdjacentHTML('afterbegin', messageBox);
                messagesDiv.scrollTop = messagesDiv.scrollHeight; // ìŠ¤í¬ë¡¤ì„ ì•„ë˜ë¡œ
            });
        });
    }

    function sendMessage() {
        const messageInput = document.getElementById("message");
        const message = messageInput.value.trim(); // ì…ë ¥ëœ ë©”ì‹œì§€
        if (message) {
            stompClient.send("/app/chat/" + companyId + "/" + freelancerId, {}, JSON.stringify({ 'message': message, 'companyId': companyId }));
            messageInput.value = ""; // ì…ë ¥ë€ ë¹„ìš°ê¸°
        }
    }

    // Enter í‚¤ë¡œ ë©”ì‹œì§€ ì „ì†¡
    document.getElementById("message").addEventListener("keypress", function(event) {
        if (event.key === "Enter") { // Enter í‚¤ê°€ ëˆŒë¦¬ë©´
            sendMessage(); // ë©”ì‹œì§€ ì „ì†¡ í•¨ìˆ˜ í˜¸ì¶œ
            event.preventDefault(); // ê¸°ë³¸ Enter ë™ì‘ ë°©ì§€
        }
    });

    // ì±„íŒ…ë°© í‘œì‹œ í•¨ìˆ˜
    function showChatRoom() {
        const chatRoom = document.getElementById('chat-room');
        const inputGroup = document.getElementById('input-group');
        chatRoom.style.display = 'block'; // ì±„íŒ…ë°© í‘œì‹œ
        inputGroup.style.display = 'flex'; // ì…ë ¥ ê·¸ë£¹ í‘œì‹œ
        document.getElementById('chat-icon').style.display = 'none'; // ì±„íŒ… ì•„ì´ì½˜ ìˆ¨ê¸°ê¸°
    }

    // ë’¤ë¡œê°€ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ
    document.getElementById('back-button').onclick = function() {
        const chatRoom = document.getElementById('chat-room');
        const inputGroup = document.getElementById('input-group');
        chatRoom.style.display = 'none'; // ì±„íŒ…ë°© ìˆ¨ê¸°ê¸°
        inputGroup.style.display = 'none'; // ì…ë ¥ ê·¸ë£¹ ìˆ¨ê¸°ê¸°
        document.getElementById('chat-icon').style.display = 'block'; // ì±„íŒ… ì•„ì´ì½˜ ë³´ì´ê¸°
    }

    connect(); // ì›¹ì†Œì¼“ ì—°ê²°
</script>
</body>
</html>
